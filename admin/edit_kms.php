<?php
ob_start();
session_start();
require_once '../koneksi.php';
$title = "Edit Data KMS | Posyandu Melati";

// Cek apakah sesi login ada
if (!isset($_SESSION['login']) || $_SESSION['login'] !== true) {
    header('Location: login.php');
    exit();
}

// Tarik ID KMS dari URL
$id_kms = isset($_GET['id_kms']) ? $_GET['id_kms'] : 0;

if ($id_kms == 0) {
    header('Location: data_kms.php');
    exit();
}

// Query untuk mendapatkan data KMS berdasarkan id_kms
try {
    $stmt = $koneksi->prepare("SELECT tb_kms.*, tb_balita.nama_balita, tb_balita.jenis_kelamin, tb_balita.nama_ibu, tb_balita.p_persalinan 
                               FROM tb_kms 
                               JOIN tb_balita ON tb_kms.id_balita = tb_balita.id_balita 
                               WHERE id_kms = ?");
    $stmt->bind_param("i", $id_kms);
    $stmt->execute();
    $result = $stmt->get_result();
    $data = $result->fetch_assoc();

    if (!$data) {
        header('Location: data_kms.php');
        exit();
    }
} catch (Exception $e) {
    echo "Error: " . $e->getMessage();
    exit();
}

require_once 'include/header.php';
require_once 'include/navbar.php';
require_once 'include/sidebar.php';
?>

<div class="content-wrapper">
    <div class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1 class="m-0">Edit Data KMS</h1>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
                        <li class="breadcrumb-item active">Edit Data KMS</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Edit Data KMS</h3>
                        </div>
                        <div class="card-body">
                            <form action="proses_admin/p_edit_kms.php" method="POST" id="editKMSForm">
                                <input type="hidden" name="id_kms" value="<?php echo htmlspecialchars($data['id_kms']); ?>">

                                <div class="form-group">
                                    <label>Nama Balita</label>
                                    <input type="text" name="nama_balita" class="form-control" value="<?php echo htmlspecialchars($data['nama_balita']); ?>" readonly>
                                </div>

                                <div class="form-group">
                                    <label>Jenis Kelamin</label>
                                    <input type="text" name="jenis_kelamin" class="form-control" value="<?php echo htmlspecialchars($data['jenis_kelamin']); ?>" readonly id="jenis_kelamin">
                                </div>

                                <div class="form-group">
                                    <label>Nama Ibu</label>
                                    <input type="text" name="nama_ibu" class="form-control" value="<?php echo htmlspecialchars($data['nama_ibu']); ?>" readonly>
                                </div>

                                <div class="form-group">
                                    <label>Penolong Persalinan</label>
                                    <input type="text" name="p_persalinan" class="form-control" value="<?php echo htmlspecialchars($data['p_persalinan']); ?>" readonly>
                                </div>

                                <div class="form-group">
                                    <label for="umur">Umur (Bulan)</label>
                                    <select id="umur" name="umur" class="form-control" required>
                                        <?php
                                        for ($i = 0; $i <= 60; $i++) {
                                            $selected = ($data['umur'] == $i) ? 'selected' : '';
                                            echo "<option value=\"$i\" $selected>$i</option>";
                                        }
                                        ?>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label>Tinggi Badan (cm)</label>
                                    <input type="number" name="tinggi_badan" class="form-control" value="<?php echo htmlspecialchars($data['tinggi_badan']); ?>" id="tinggi_badan" step="0.01" required>
                                </div>

                                <div class="form-group">
                                    <label>Berat Badan (kg)</label>
                                    <input type="number" name="berat_badan" class="form-control" value="<?php echo htmlspecialchars($data['berat_badan']); ?>" id="berat_badan" step="0.01" required>
                                </div>

                                <div class="form-group">
                                    <label>Status Gizi BB/U</label>
                                    <input type="text" name="status_gizi_bb_umur" class="form-control" value="<?php echo htmlspecialchars($data['status_gizi_bb_umur']); ?>" id="status_gizi_bb_umur" readonly>
                                </div>

                                <div class="form-group">
                                    <label>Status Gizi BB/TB</label>
                                    <input type="text" name="status_gizi_bb_tinggi" class="form-control" value="<?php echo htmlspecialchars($data['status_gizi_bb_tinggi']); ?>" id="status_gizi_bb_tinggi" readonly>
                                </div>

                                <button type="submit" class="btn btn-success">Simpan Perubahan</button>
                                <a href="data_kms.php" class="btn btn-secondary">Kembali</a>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<?php require_once 'include/footer.php'; ?>

<!-- JavaScript untuk validasi data KMS -->
<script>
    var table_umur = {
        'Laki-laki': {
            0: [2.1, 2.5, 2.3, 3.3, 3.9, 4.4, 5.0],
            1: [2.9, 3.4, 3.9, 4.5, 5.1, 5.8, 6.6],
            2: [3.8, 4.3, 4.9, 5.6, 6.3, 7.1, 8.0],
            3: [4.4, 5.0, 5.7, 6.4, 7.2, 8.0, 9.0],
            4: [4.9, 5.6, 6.2, 7.0, 7.8, 8.7, 9.7],
            5: [5.3, 6.0, 6.7, 7.5, 8.4, 9.3, 10.4],
            6: [5.7, 6.4, 7.1, 7.9, 8.8, 9.8, 10.9],
            7: [5.9, 6.7, 7.4, 8.3, 9.2, 10.3, 11.4],
            8: [6.2, 6.9, 7.7, 8.6, 9.6, 10.7, 11.9],
            9: [6.4, 7.1, 8.0, 8.9, 9.9, 11.0, 12.3],
            10: [6.6, 7.4, 8.2, 9.2, 10.2, 11.4, 12.7],
            11: [6.8, 7.6, 8.4, 9.4, 10.5, 11.7, 13.0],
            12: [6.9, 7.7, 8.6, 9.6, 10.8, 12.0, 13.3],
            13: [7.1, 7.9, 8.8, 9.9, 11.0, 12.3, 13.7],
            14: [7.2, 8.1, 9.0, 10.1, 11.3, 12.6, 14.0],
            15: [7.4, 8.3, 9.2, 10.3, 11.5, 12.8, 14.3],
            16: [7.5, 8.4, 9.4, 10.5, 11.7, 13.1, 14.6],
            17: [7.7, 8.6, 9.6, 10.7, 12.0, 13.4, 14.9],
            18: [7.8, 8.8, 9.8, 10.9, 12.2, 13.7, 15.3],
            19: [8.0, 8.9, 10.0, 11.1, 12.5, 13.9, 15.6],
            20: [8.1, 9.1, 10.1, 11.3, 12.7, 14.2, 15.9],
            21: [8.2, 9.2, 10.3, 11.5, 12.9, 14.5, 16.2],
            22: [8.4, 9.4, 10.5, 11.8, 13.2, 14.7, 16.5],
            23: [8.5, 9.5, 10.7, 12.0, 13.4, 15.0, 16.8],
            24: [8.6, 9.7, 10.8, 12.2, 13.6, 15.3, 17.1],
            25: [8.8, 9.8, 11.0, 12.4, 13.9, 15.5, 17.5],
            26: [8.9, 10.0, 11.2, 12.5, 14.1, 15.8, 17.8],
            27: [9.0, 10.1, 11.3, 12.7, 14.3, 16.1, 18.1],
            28: [9.1, 10.2, 11.5, 12.9, 14.5, 16.3, 18.4],
            29: [9.2, 10.4, 11.7, 13.1, 14.8, 16.6, 18.7],
            30: [9.4, 10.5, 11.8, 13.3, 15.0, 16.9, 19.0],
            31: [9.5, 10.7, 12.0, 13.5, 15.2, 17.1, 19.3],
            32: [9.6, 10.8, 12.1, 13.7, 15.4, 17.4, 19.6],
            33: [9.7, 10.9, 12.3, 13.8, 15.6, 17.6, 19.9],
            34: [9.8, 11.0, 12.4, 14.0, 15.8, 17.8, 20.2],
            35: [9.9, 11.2, 12.6, 14.2, 16.0, 18.1, 20.4],
            36: [10.0, 11.3, 12.7, 14.3, 16.2, 18.3, 20.7],
            37: [10.1, 11.4, 12.9, 14.5, 16.4, 18.6, 21.0],
            38: [10.2, 11.5, 13.0, 14.7, 16.6, 18.8, 21.3],
            39: [10.3, 11.6, 13.1, 14.8, 16.8, 19.0, 21.6],
            40: [10.4, 11.8, 13.3, 15.0, 17.0, 19.3, 21.9],
            41: [10.5, 11.9, 13.4, 15.2, 17.2, 19.5, 22.1],
            42: [10.6, 12.0, 13.6, 15.3, 17.4, 19.7, 22.4],
            43: [10.7, 12.1, 13.7, 15.5, 17.6, 20.0, 22.7],
            44: [10.8, 12.2, 13.8, 15.7, 17.8, 20.2, 23.0],
            45: [10.9, 12.4, 14.0, 15.8, 18.0, 20.5, 23.3],
            46: [11.0, 12.5, 14.1, 16.0, 18.2, 20.7, 23.6],
            47: [11.1, 12.6, 14.3, 16.2, 18.4, 20.9, 23.9],
            48: [11.2, 12.7, 14.4, 16.3, 18.6, 21.2, 24.2],
            49: [11.3, 12.8, 14.5, 16.5, 18.8, 21.4, 24.5],
            50: [11.4, 12.9, 14.7, 16.7, 19.0, 21.7, 24.8],
            51: [11.5, 13.1, 14.8, 16.8, 19.2, 21.9, 25.1],
            52: [11.6, 13.2, 15.0, 17.0, 19.4, 22.2, 25.4],
            53: [11.7, 13.3, 15.1, 17.2, 19.6, 22.4, 25.7],
            54: [11.8, 13.4, 15.2, 17.3, 19.8, 22.7, 26.0],
            55: [11.9, 13.5, 15.4, 17.5, 20.0, 22.9, 26.3],
            56: [12.0, 13.6, 15.5, 17.7, 20.2, 23.2, 26.6],
            57: [12.1, 13.7, 15.6, 17.8, 20.4, 23.4, 26.9],
            58: [12.2, 13.8, 15.8, 18.0, 20.6, 23.7, 27.2],
            59: [12.3, 14.0, 15.9, 18.2, 20.8, 23.9, 27.6],
            60: [12.4, 14.1, 16.0, 18.3, 21.0, 24.2, 27.9]
        },
        'Perempuan': {
            0: [2.0, 2.4, 2.8, 3.2, 3.7, 4.2, 4.8],
            1: [2.7, 3.2, 3.6, 4.2, 4.8, 5.5, 6.2],
            2: [3.4, 3.9, 4.5, 5.1, 5.8, 6.6, 7.5],
            3: [4.0, 4.5, 5.2, 5.8, 6.6, 7.5, 8.5],
            4: [4.4, 5.0, 5.7, 6.4, 7.3, 8.2, 9.3],
            5: [4.8, 5.4, 6.1, 6.9, 7.8, 8.8, 10.0],
            6: [5.1, 5.7, 6.5, 7.3, 8.2, 9.3, 10.6],
            7: [5.3, 6.0, 6.8, 7.6, 8.6, 9.8, 11.1],
            8: [5.6, 6.3, 7.0, 7.9, 9.0, 10.2, 11.6],
            9: [5.8, 6.5, 7.3, 8.2, 9.3, 10.5, 12.0],
            10: [5.9, 6.7, 7.5, 8.5, 9.6, 10.9, 12.4],
            11: [6.1, 6.9, 7.7, 8.7, 9.9, 11.2, 12.8],
            12: [6.3, 7.0, 7.9, 8.9, 10.1, 11.5, 13.1],
            13: [6.4, 7.2, 8.1, 9.2, 10.4, 11.8, 13.5],
            14: [6.6, 7.4, 8.3, 9.4, 10.6, 12.1, 13.8],
            15: [6.7, 7.6, 8.5, 9.6, 10.9, 12.4, 14.1],
            16: [6.9, 7.7, 8.7, 9.8, 11.1, 12.6, 14.5],
            17: [7.0, 7.9, 8.9, 10.0, 11.4, 12.9, 14.8],
            18: [7.2, 8.1, 9.1, 10.2, 11.6, 13.2, 15.1],
            19: [7.3, 8.2, 9.2, 10.4, 11.8, 13.5, 15.4],
            20: [7.5, 8.4, 9.4, 10.6, 12.1, 13.7, 15.7],
            21: [7.6, 8.6, 9.6, 10.9, 12.3, 14.0, 16.0],
            22: [7.8, 8.7, 9.8, 11.1, 12.5, 14.3, 16.4],
            23: [7.9, 8.9, 10.0, 11.3, 12.8, 14.6, 16.7],
            24: [8.1, 9.0, 10.2, 11.5, 13.0, 14.8, 17.0],
            25: [8.2, 9.2, 10.3, 11.7, 13.3, 15.1, 17.3],
            26: [8.4, 9.4, 10.5, 11.9, 13.5, 15.4, 17.7],
            27: [8.5, 9.5, 10.7, 12.1, 13.7, 15.7, 18.0],
            28: [8.6, 9.7, 10.9, 12.3, 14.0, 16.0, 18.3],
            29: [8.8, 9.8, 11.1, 12.5, 14.2, 16.2, 18.7],
            30: [8.9, 10.0, 11.2, 12.7, 14.4, 16.5, 19.0],
            31: [9.0, 10.1, 11.4, 12.9, 14.7, 16.8, 19.3],
            32: [9.1, 10.3, 11.6, 13.1, 14.9, 17.1, 19.6],
            33: [9.3, 10.4, 11.7, 13.3, 15.1, 17.3, 20.0],
            34: [9.4, 10.5, 11.9, 13.5, 15.4, 17.6, 20.3],
            35: [9.5, 10.7, 12.0, 13.7, 15.6, 17.9, 20.6],
            36: [9.6, 10.8, 12.2, 13.9, 15.8, 18.1, 20.9],
            37: [9.7, 10.9, 12.4, 14.0, 16.0, 18.4, 21.3],
            38: [9.8, 11.1, 12.5, 14.2, 16.3, 18.7, 21.6],
            39: [9.9, 11.2, 12.7, 14.4, 16.5, 19.0, 22.0],
            40: [10.1, 11.3, 12.8, 14.6, 16.7, 19.2, 22.3],
            41: [10.2, 11.5, 13.0, 14.8, 16.9, 19.5, 22.7],
            42: [10.3, 11.6, 13.1, 15.0, 17.2, 19.8, 23.0],
            43: [10.4, 11.7, 13.3, 15.2, 17.4, 20.1, 23.4],
            44: [10.5, 11.8, 13.4, 15.3, 17.6, 20.4, 23.7],
            45: [10.6, 12.0, 13.6, 15.5, 17.8, 20.7, 24.1],
            46: [10.7, 12.1, 13.7, 15.7, 18.1, 20.9, 24.5],
            47: [10.8, 12.2, 13.9, 15.9, 18.3, 21.2, 24.8],
            48: [10.9, 12.3, 14.0, 16.1, 18.5, 21.5, 25.2],
            49: [11.0, 12.4, 14.2, 16.3, 18.8, 21.8, 25.5],
            50: [11.1, 12.6, 14.3, 16.4, 19.0, 22.1, 25.9],
            51: [11.2, 12.7, 14.5, 16.6, 19.2, 22.4, 26.3],
            52: [11.3, 12.8, 14.6, 16.8, 19.4, 22.6, 26.6],
            53: [11.4, 12.9, 14.8, 17.0, 19.7, 22.9, 27.0],
            54: [11.5, 13.0, 14.9, 17.2, 19.9, 23.2, 27.4],
            55: [11.6, 13.2, 15.1, 17.3, 20.1, 23.5, 27.7],
            56: [11.7, 13.3, 15.2, 17.5, 20.3, 23.8, 28.1],
            57: [11.8, 13.4, 15.3, 17.7, 20.6, 24.1, 28.5],
            58: [11.9, 13.5, 15.5, 17.9, 20.8, 24.4, 28.8],
            59: [12.0, 13.6, 15.6, 18.0, 21.0, 24.6, 29.2],
            60: [12.1, 13.7, 15.8, 18.2, 21.2, 24.9, 29.5]
        }
    };

    var table_tinggi = {
        'Laki-laki': {
            65.0: [5.9, 6.3, 6.9, 7.4, 8.1, 8.8, 9.6],
            65.5: [6.0, 6.4, 7.0, 7.6, 8.2, 8.9, 9.8],
            66.0: [6.1, 6.5, 7.1, 7.7, 8.3, 9.1, 9.9],
            66.5: [6.1, 6.6, 7.2, 7.8, 8.5, 9.2, 10.1],
            67.0: [6.2, 6.7, 7.3, 7.9, 8.6, 9.4, 10.2],
            67.5: [6.3, 6.8, 7.4, 8.0, 8.7, 9.5, 10.4],
            68.0: [6.4, 6.9, 7.5, 8.1, 8.8, 9.6, 10.5],
            68.5: [6.5, 7.0, 7.6, 8.2, 9.0, 9.8, 10.7],
            69.0: [6.6, 7.1, 7.7, 8.4, 9.1, 9.9, 10.8],
            69.5: [6.7, 7.2, 7.8, 8.5, 9.2, 10.0, 11.0],
            70.0: [6.8, 7.3, 7.9, 8.6, 9.3, 10.2, 11.1],
            70.5: [6.9, 7.4, 8.0, 8.7, 9.5, 10.3, 11.3],
            71.0: [6.9, 7.5, 8.1, 8.8, 9.6, 10.4, 11.3],
            71.5: [7.0, 7.6, 8.2, 8.9, 9.7, 10.6, 11.6],
            72.0: [7.1, 7.7, 8.3, 9.0, 9.8, 10.7, 11.7],
            72.5: [7.2, 7.8, 8.4, 9.1, 9.9, 10.8, 11.8],
            73.0: [7.3, 7.9, 8.5, 9.2, 10.0, 11.0, 12.0],
            73.5: [7.4, 7.9, 8.6, 9.3, 10.2, 11.1, 12.1],
            74.0: [7.4, 8.0, 8.7, 9.4, 10.3, 11.2, 12.2],
            74.5: [7.5, 8.1, 8.8, 9.5, 10.4, 11.3, 12.4],
            75.0: [7.6, 8.2, 8.9, 9.6, 10.5, 11.4, 12.5],
            75.5: [7.7, 8.3, 9.0, 9.7, 10.6, 11.6, 12.6],
            76.0: [7.7, 8.4, 9.1, 9.8, 10.7, 11.7, 12.8],
            76.5: [7.8, 8.5, 9.2, 9.9, 10.8, 11.8, 12.9],
            77.0: [7.9, 8.5, 9.2, 10.0, 10.9, 11.9, 13.0],
            77.5: [8.0, 8.6, 9.3, 10.1, 11.0, 12.0, 13.1],
            78.0: [8.0, 8.7, 9.4, 10.2, 11.1, 12.1, 13.3],
            78.5: [8.1, 8.8, 9.5, 10.3, 11.2, 12.2, 13.4],
            79.0: [8.2, 8.8, 9.6, 10.4, 11.3, 12.3, 13.5],
            79.5: [8.3, 8.9, 9.7, 10.5, 11.4, 12.4, 13.6],
            80.0: [8.3, 9.0, 9.7, 10.6, 11.5, 12.6, 13.7],
            80.5: [8.4, 9.1, 9.8, 10.7, 11.6, 12.7, 13.8],
            81.0: [8.5, 9.2, 9.9, 10.8, 11.7, 12.8, 14.0],
            81.5: [8.6, 9.3, 10.0, 10.9, 11.8, 12.9, 14.1],
            82.0: [8.7, 9.3, 10.1, 11.0, 11.9, 13.0, 14.2],
            82.5: [8.7, 9.4, 10.2, 11.1, 12.1, 13.1, 14.4],
            83.0: [8.8, 9.5, 10.3, 11.2, 12.2, 13.3, 14.5],
            83.5: [8.9, 9.6, 10.4, 11.3, 12.3, 13.4, 14.6],
            84.0: [9.0, 9.7, 10.5, 11.4, 12.4, 13.5, 14.8],
            84.5: [9.1, 9.9, 10.7, 11.5, 12.5, 13.7, 14.9],
            85.0: [9.2, 10.0, 10.8, 11.7, 12.7, 13.8, 15.1],
            85.5: [9.3, 10.1, 10.9, 11.8, 12.8, 13.9, 15.2],
            86.0: [9.4, 10.2, 11.0, 11.9, 12.9, 14.1, 15.4],
            86.5: [9.5, 10.3, 11.1, 12.0, 13.1, 14.2, 15.5],
            87.0: [9.6, 10.4, 11.2, 12.2, 13.2, 14.4, 15.7],
            87.5: [9.7, 10.5, 11.3, 12.3, 13.3, 14.5, 15.8],
            88.0: [9.8, 10.6, 11.5, 12.4, 13.5, 14.7, 16.0],
            88.5: [9.9, 10.7, 11.6, 12.5, 13.6, 14.8, 16.1],
            89.0: [10.0, 10.8, 11.7, 12.6, 13.7, 14.9, 16.3],
            89.5: [10.1, 10.9, 11.8, 12.8, 13.9, 15.1, 16.4],
            90.0: [10.2, 11.0, 11.9, 12.9, 14.0, 15.2, 16.6],
            90.5: [10.3, 11.1, 12.0, 13.0, 14.1, 15.3, 16.7],
            91.0: [10.4, 11.2, 12.1, 13.1, 14.2, 15.5, 16.9],
            91.5: [10.5, 11.3, 12.2, 13.2, 14.4, 15.6, 17.0],
            92.0: [10.6, 11.4, 12.3, 13.4, 14.5, 15.8, 17.2],
            92.5: [10.7, 11.5, 12.4, 13.5, 14.6, 15.9, 17.3],
            93.0: [10.8, 11.6, 12.6, 13.6, 14.7, 16.0, 17.5],
            93.5: [10.9, 11.7, 12.7, 13.7, 14.9, 16.2, 17.6],
            94.0: [11.0, 11.8, 12.8, 13.8, 15.0, 16.3, 17.8],
            94.5: [11.1, 11.9, 12.9, 13.9, 15.1, 16.5, 17.9],
            95.0: [11.1, 12.0, 13.0, 14.1, 15.3, 16.6, 18.1],
            95.5: [11.2, 12.1, 13.1, 14.2, 15.4, 16.7, 18.3],
            96.0: [11.3, 12.2, 13.2, 14.3, 15.5, 16.9, 18.4],
            96.5: [11.4, 12.3, 13.3, 14.4, 15.7, 17.0, 18.6],
            97.0: [11.5, 12.4, 13.4, 15.8, 15.8, 17.2, 18.8],
            97.5: [11.6, 12.5, 13.6, 15.9, 15.9, 17.4, 18.9],
            98.0: [11.7, 12.6, 13.7, 16.1, 16.1, 17.5, 19.1],
            98.5: [11.8, 12.8, 13.8, 16.2, 16.2, 17.7, 19.3],
            99.0: [11.9, 12.9, 13.9, 16.4, 16.4, 17.9, 19.5],
            99.5: [12.0, 13.0, 14.0, 16.5, 16.5, 18.0, 19.7],
            100.0: [12.1, 13.1, 14.2, 16.7, 16.7, 18.2, 19.9],
            100.5: [12.2, 13.2, 14.3, 16.9, 16.9, 18.4, 20.1],
            101.0: [12.3, 13.3, 14.4, 17.0, 17.0, 18.5, 20.3],
            101.5: [12.4, 13.4, 14.5, 17.2, 17.2, 18.7, 20.5],
            102.0: [12.5, 13.6, 14.7, 17.3, 17.3, 18.9, 20.7],
            102.5: [12.6, 13.7, 14.8, 17.5, 17.5, 19.1, 20.9],
            103.0: [12.8, 13.8, 14.9, 16.2, 17.7, 19.3, 21.1],
            103.5: [12.9, 13.9, 15.1, 16.4, 17.8, 19.5, 21.3],
            104.0: [13.0, 14.0, 15.2, 16.5, 18.0, 19.7, 21.6],
            104.5: [13.1, 14.2, 15.4, 16.7, 18.2, 19.9, 21.8],
            105.0: [13.2, 14.3, 15.5, 16.8, 18.4, 20.1, 22.0],
            105.5: [13.3, 14.4, 15.6, 17.0, 18.5, 20.3, 22.2],
            106.0: [13.4, 14.5, 15.8, 17.2, 18.7, 20.5, 22.5],
            106.5: [13.5, 14.7, 15.9, 17.3, 18.9, 20.7, 22.7],
            107.0: [13.7, 14.8, 16.1, 17.5, 19.1, 20.9, 22.9],
            107.5: [13.8, 14.9, 16.2, 17.7, 19.3, 21.1, 23.2],
            108.0: [13.9, 15.1, 16.4, 17.8, 19.5, 21.3, 23.4],
            108.5: [14.0, 15.2, 16.5, 18.0, 19.7, 21.5, 23.7],
            109.0: [14.1, 15.3, 16.7, 18.2, 19.8, 21.8, 23.9],
            109.5: [14.3, 15.5, 16.8, 18.3, 20.0, 22.0, 24.2],
            110.0: [14.4, 15.6, 17.0, 18.5, 20.2, 22.2, 24.4],
            110.5: [14.5, 15.8, 17.1, 18.7, 20.4, 22.4, 24.7],
            111.0: [14.6, 15.9, 17.3, 18.9, 20.7, 22.7, 25.0],
            111.5: [14.8, 16.0, 17.5, 19.1, 20.9, 22.9, 25.2],
            112.0: [14.9, 16.2, 17.6, 19.2, 21.1, 23.1, 25.5],
            112.5: [15.0, 16.3, 17.8, 19.4, 21.3, 23.4, 25.8],
            113.0: [15.2, 16.5, 18.0, 19.6, 21.5, 23.6, 26.0],
            113.5: [15.3, 16.6, 18.1, 19.8, 21.7, 23.9, 26.3],
            114.0: [15.4, 16.8, 18.3, 20.0, 21.9, 24.1, 26.5],
            114.5: [15.6, 16.9, 18.5, 20.2, 22.1, 24.4, 26.9],
            115.0: [15.7, 17.1, 18.6, 20.4, 22.4, 24.6, 27.2],
            115.5: [15.8, 17.2, 18.8, 20.6, 22.6, 24.9, 27.5],
            116.0: [16.0, 17.4, 19.0, 20.8, 22.8, 25.1, 27.8],
            116.5: [16.1, 17.5, 19.2, 21.0, 23.0, 25.4, 28.0],
            117.0: [16.2, 17.7, 19.3, 21.2, 23.3, 25.6, 28.3],
            117.5: [16.4, 17.9, 19.5, 21.4, 23.5, 25.9, 28.6],
            118.0: [16.5, 18.0, 19.7, 21.6, 23.7, 26.1, 28.9],
            118.5: [16.7, 18.2, 19.9, 21.8, 23.9, 26.4, 29.2],
            119.0: [16.8, 18.3, 20.0, 22.0, 24.1, 26.6, 29.5],
            119.5: [16.9, 18.5, 20.2, 22.2, 24.4, 26.9, 29.8],
            120.0: [17.1, 18.6, 20.4, 22.4, 24.6, 27.2, 30.1]
        },
        'Perempuan': {
            65.0: [5.6, 6.1, 6.6, 7.2, 7.9, 8.7, 9.7],
            65.5: [5.7, 6.2, 6.7, 7.4, 8.1, 8.9, 9.8],
            66.0: [5.8, 6.3, 6.8, 7.5, 8.2, 9.0, 10.0],
            66.5: [5.8, 6.4, 6.9, 7.6, 8.3, 9.1, 10.1],
            67.0: [5.9, 6.4, 7.0, 7.7, 8.4, 9.3, 10.2],
            67.5: [6.0, 6.5, 7.1, 7.8, 8.5, 9.4, 10.4],
            68.0: [6.1, 6.6, 7.2, 7.9, 8.7, 9.5, 10.5],
            68.5: [6.2, 6.7, 7.3, 8.0, 8.8, 9.7, 10.7],
            69.0: [6.3, 6.8, 7.4, 8.1, 8.9, 9.8, 10.8],
            69.5: [6.3, 6.9, 7.5, 8.2, 9.0, 9.9, 10.9],
            70.0: [6.4, 7.0, 7.6, 8.3, 9.1, 10.0, 11.1],
            70.5: [6.5, 7.1, 7.7, 8.4, 9.2, 10.1, 11.2],
            71.0: [6.6, 7.1, 7.8, 8.5, 9.3, 10.3, 11.3],
            71.5: [6.7, 7.2, 7.9, 8.6, 9.4, 10.4, 11.5],
            72.0: [6.7, 7.3, 8.0, 8.7, 9.5, 10.5, 11.6],
            72.5: [6.8, 7.4, 8.1, 8.8, 9.7, 10.6, 11.7],
            73.0: [6.9, 7.5, 8.1, 8.9, 9.8, 10.7, 11.8],
            73.5: [7.0, 7.6, 8.2, 9.0, 9.9, 10.8, 12.0],
            74.0: [7.0, 7.6, 8.3, 9.1, 10.0, 11.0, 12.1],
            74.5: [7.1, 7.7, 8.4, 9.2, 10.1, 11.1, 12.2],
            75.0: [7.2, 7.8, 8.5, 9.3, 10.2, 11.2, 12.3],
            75.5: [7.2, 7.9, 8.6, 9.4, 10.3, 11.3, 12.5],
            76.0: [7.3, 8.0, 8.7, 9.5, 10.4, 11.4, 12.6],
            76.5: [7.4, 8.0, 8.7, 9.6, 10.5, 11.5, 12.7],
            77.0: [7.5, 8.1, 8.8, 9.6, 10.6, 11.6, 12.8],
            77.5: [7.5, 8.2, 8.9, 9.7, 10.7, 11.7, 12.9],
            78.0: [7.6, 8.3, 9.0, 9.8, 10.8, 11.8, 13.1],
            78.5: [7.7, 8.4, 9.1, 9.9, 10.9, 12.0, 13.2],
            79.0: [7.8, 8.4, 9.2, 10.0, 11.0, 12.1, 13.3],
            79.5: [7.8, 8.5, 9.3, 10.1, 11.1, 12.2, 13.4],
            80.0: [7.9, 8.6, 9.4, 10.2, 11.2, 12.3, 13.6],
            80.5: [8.0, 8.7, 9.5, 10.3, 11.3, 12.4, 13.7],
            81.0: [8.1, 8.8, 9.6, 10.4, 11.4, 12.6, 13.9],
            81.5: [8.2, 8.9, 9.7, 10.6, 11.6, 12.7, 14.0],
            82.0: [8.3, 9.0, 9.8, 10.7, 11.7, 12.8, 14.1],
            82.5: [8.4, 9.1, 9.9, 10.8, 11.8, 13.0, 14.3],
            83.0: [8.5, 9.2, 10.0, 10.9, 11.9, 13.1, 14.5],
            83.5: [8.5, 9.3, 10.1, 11.0, 12.1, 13.3, 14.6],
            84.0: [8.6, 9.4, 10.2, 11.1, 12.2, 13.4, 14.8],
            84.5: [8.7, 9.5, 10.3, 11.3, 12.3, 13.5, 14.9],
            85.0: [8.8, 9.6, 10.4, 11.4, 12.5, 13.7, 15.1],
            85.5: [8.9, 9.7, 10.6, 11.5, 12.6, 13.8, 15.3],
            86.0: [9.0, 9.8, 10.7, 11.6, 12.7, 14.0, 15.4],
            86.5: [9.1, 9.9, 10.8, 11.8, 12.9, 14.2, 15.6],
            87.0: [9.2, 10.0, 10.9, 11.9, 13.0, 14.3, 15.8],
            87.5: [9.3, 10.1, 11.0, 12.0, 13.2, 14.5, 15.9],
            88.0: [9.4, 10.2, 11.1, 12.1, 13.3, 14.6, 16.1],
            88.5: [9.5, 10.3, 11.2, 12.3, 13.4, 14.8, 16.3],
            89.0: [9.6, 10.4, 11.4, 12.4, 13.6, 14.9, 16.4],
            89.5: [9.7, 10.5, 11.5, 12.5, 13.7, 15.0, 16.6],
            90.0: [9.8, 10.6, 11.6, 12.6, 13.8, 15.2, 16.8],
            90.5: [9.9, 10.7, 11.7, 12.8, 14.0, 15.4, 16.9],
            91.0: [10.0, 10.9, 11.8, 12.9, 14.1, 15.5, 17.1],
            91.5: [10.1, 11.0, 11.9, 13.0, 14.3, 15.7, 17.3],
            92.0: [10.2, 11.1, 12.0, 13.1, 14.4, 15.8, 17.4],
            92.5: [10.3, 11.2, 12.1, 13.3, 14.5, 16.0, 17.6],
            93.0: [10.4, 11.3, 12.3, 13.4, 14.7, 16.1, 17.8],
            93.5: [10.5, 11.4, 12.4, 13.5, 14.8, 16.3, 17.9],
            94.0: [10.6, 11.5, 12.5, 13.6, 14.9, 16.4, 18.1],
            94.5: [10.7, 11.6, 12.6, 13.8, 15.1, 16.6, 18.3],
            95.0: [10.8, 11.7, 12.7, 13.9, 15.2, 16.7, 18.5],
            95.5: [10.8, 11.8, 12.8, 14.0, 15.4, 16.9, 18.6],
            96.0: [10.9, 11.9, 12.9, 14.1, 15.5, 17.0, 18.8],
            96.5: [11.0, 12.0, 13.1, 14.3, 15.6, 17.2, 19.0],
            97.0: [11.1, 12.1, 13.2, 14.4, 15.8, 17.4, 19.2],
            97.5: [11.2, 12.2, 13.3, 14.5, 15.9, 17.5, 19.3],
            98.0: [11.3, 12.3, 13.4, 14.7, 16.1, 17.7, 19.5],
            98.5: [11.4, 12.4, 13.5, 14.8, 16.2, 17.9, 19.7],
            99.0: [11.5, 12.5, 13.7, 14.9, 16.4, 18.0, 19.9],
            99.5: [11.6, 12.7, 13.8, 15.1, 16.5, 18.2, 20.1],
            100.0: [11.7, 12.8, 13.9, 15.2, 16.7, 18.4, 20.3],
            100.5: [11.9, 12.9, 14.1, 15.4, 16.9, 18.6, 20.5],
            101.0: [12.0, 13.0, 14.2, 15.5, 17.0, 18.7, 20.7],
            101.5: [12.1, 13.1, 14.3, 15.7, 17.2, 18.9, 20.9],
            102.0: [12.2, 13.3, 14.5, 15.8, 17.4, 19.1, 21.1],
            102.5: [12.3, 13.4, 14.5, 16.0, 17.5, 19.3, 21.4],
            103.0: [12.4, 13.5, 14.7, 16.1, 17.7, 19.5, 21.6],
            103.5: [12.5, 13.6, 14.9, 16.3, 17.9, 19.7, 21.8],
            104.0: [12.6, 13.8, 15.0, 16.4, 18.1, 19.9, 22.0],
            104.5: [12.8, 13.9, 15.2, 16.6, 18.2, 20.1, 22.3],
            105.0: [12.9, 14.0, 15.3, 16.8, 18.4, 20.3, 22.5],
            105.5: [13.0, 14.2, 15.5, 16.9, 18.6, 20.5, 22.7],
            106.0: [13.1, 14.3, 15.6, 17.1, 18.8, 20.8, 23.0],
            106.5: [13.3, 14.5, 15.8, 17.3, 19.0, 21.0, 23.2],
            107.0: [13.4, 14.6, 15.9, 17.5, 19.2, 21.2, 23.5],
            107.5: [13.5, 14.7, 16.1, 17.7, 19.4, 21.4, 23.7],
            108.0: [13.7, 14.9, 16.3, 17.8, 19.6, 21.7, 24.0],
            108.5: [13.8, 15.0, 16.4, 18.0, 19.8, 21.9, 24.3],
            109.0: [13.9, 15.2, 16.6, 18.2, 20.0, 22.1, 24.5],
            109.5: [14.1, 15.4, 16.8, 18.4, 20.3, 22.4, 24.8],
            110.0: [14.2, 15.5, 17.0, 18.6, 20.5, 22.6, 25.1],
            110.5: [14.4, 15.7, 17.1, 18.8, 20.7, 22.9, 25.4],
            111.0: [14.5, 15.8, 17.3, 19.0, 20.9, 23.1, 25.7],
            111.5: [14.7, 16.0, 17.5, 19.2, 21.2, 23.4, 26.0],
            112.0: [14.8, 16.2, 17.7, 19.4, 21.4, 23.6, 26.2],
            112.5: [15.0, 16.3, 17.9, 19.6, 21.6, 23.9, 26.5],
            113.0: [15.1, 16.5, 18.0, 19.8, 21.8, 24.2, 26.8],
            113.5: [15.3, 16.7, 18.2, 20.0, 22.1, 24.4, 27.1],
            114.0: [15.4, 16.8, 18.4, 20.2, 22.3, 24.7, 27.4],
            114.5: [15.6, 17.0, 18.6, 20.5, 22.6, 25.0, 27.8],
            115.0: [15.7, 17.2, 18.8, 20.7, 22.8, 25.3, 28.1],
            115.5: [15.9, 17.3, 19.0, 20.9, 23.1, 25.6, 28.4],
            116.0: [16.1, 17.5, 19.2, 21.2, 23.4, 25.8, 28.8],
            116.5: [16.2, 17.7, 19.4, 21.4, 23.6, 26.1, 29.1],
            117.0: [16.4, 17.9, 19.6, 21.6, 23.9, 26.4, 29.5],
            117.5: [16.5, 18.0, 19.8, 21.9, 24.2, 26.7, 29.9],
            118.0: [16.7, 18.2, 20.0, 22.1, 24.5, 27.0, 30.2],
            118.5: [16.9, 18.4, 20.2, 22.4, 24.7, 27.3, 30.6],
            119.0: [17.0, 18.6, 20.4, 22.7, 25.0, 27.6, 31.0],
            119.5: [17.2, 18.8, 20.6, 22.9, 25.3, 27.9, 31.4],
            120.0: [17.4, 19.0, 20.8, 23.2, 25.6, 28.2, 31.8]
        }
    };

    function calculateBBUmur(umur, berat_badan, jenis_kelamin) {
        var standar = table_umur[jenis_kelamin][umur];
        if (standar) {
            var median = standar[3]; // Index median
            var sdMinus3 = standar[0];
            var sdMinus2 = standar[1];
            var sdMinus1 = standar[2];
            var sdPlus1 = standar[4];
            var sdPlus2 = standar[5];
            var sdPlus3 = standar[6];

            if (berat_badan < sdMinus3) return 'Berat Badan Sangat Kurang';
            if (berat_badan >= sdMinus3 && berat_badan < sdMinus2) return 'Berat Badan Kurang';
            if (berat_badan >= sdMinus2 && berat_badan < sdMinus1) return 'Berat Badan Normal';
            if (berat_badan >= sdMinus1 && berat_badan <= sdPlus1) return 'Berat Badan Normal';
            if (berat_badan > sdPlus1 && berat_badan <= sdPlus2) return 'Resiko Berat Badan Lebih';
            if (berat_badan > sdPlus2 && berat_badan <= sdPlus3) return 'Resiko Berat Badan Lebih';
            if (berat_badan > sdPlus3) return 'Resiko Berat Badan Lebih';
        }
        return 'Data tidak valid, silahkan periksa data anda';
    }

    function calculateBBTinggi(tinggi_badan, berat_badan, jenis_kelamin) {
        var standar = table_tinggi[jenis_kelamin][tinggi_badan];

        if (standar) {
            var sdMinus3 = standar[0];
            var sdMinus2 = standar[1];
            var sdMinus1 = standar[2];
            var median = standar[3]; // Index median
            var sdPlus1 = standar[4];
            var sdPlus2 = standar[5];
            var sdPlus3 = standar[6];

            if (berat_badan < sdMinus3) return 'Gizi Buruk';
            if (berat_badan >= sdMinus3 && berat_badan <= sdMinus2) return 'Gizi Kurang';
            if (berat_badan > sdMinus2 && berat_badan <= sdPlus1) return 'Gizi Baik';
            if (berat_badan > sdMinus1 && berat_badan <= sdPlus2) return 'Berisiko Gizi Lebih';
            if (berat_badan > sdPlus2 && berat_badan <= sdPlus3) return 'Gizi Lebih';
            if (berat_badan > sdPlus3) return 'Obesitas';
        }

        return 'Data tidak valid, silahkan periksa data anda';
    }

    document.getElementById('umur').addEventListener('input', function() {
        var umur = parseInt(this.value);
        var berat_badan = parseFloat(document.getElementById('berat_badan').value);
        var tinggi_badan = parseFloat(document.getElementById('tinggi_badan').value);
        var jenis_kelamin = document.getElementById('jenis_kelamin').value;

        if (!isNaN(umur) && berat_badan > 0 && tinggi_badan > 0 && jenis_kelamin) {
            var status_gizi_bb_umur = document.getElementById('status_gizi_bb_umur');
            var status_gizi_bb_tinggi = document.getElementById('status_gizi_bb_tinggi');

            var statusGiziBBUmur = calculateBBUmur(umur, berat_badan, jenis_kelamin);
            var statusGiziBBTinggi = calculateBBTinggi(tinggi_badan, berat_badan, jenis_kelamin);

            status_gizi_bb_umur.value = statusGiziBBUmur;
            status_gizi_bb_tinggi.value = statusGiziBBTinggi;
        }
    });

    document.getElementById('tinggi_badan').addEventListener('input', function() {
        var umur = parseInt(document.getElementById('umur').value);
        var berat_badan = parseFloat(document.getElementById('berat_badan').value);
        var tinggi_badan = parseFloat(this.value);
        var jenis_kelamin = document.getElementById('jenis_kelamin').value;

        if (!isNaN(umur) && berat_badan > 0 && tinggi_badan > 0 && jenis_kelamin) {
            var status_gizi_bb_umur = document.getElementById('status_gizi_bb_umur');
            var status_gizi_bb_tinggi = document.getElementById('status_gizi_bb_tinggi');

            var statusGiziBBUmur = calculateBBUmur(umur, berat_badan, jenis_kelamin);
            var statusGiziBBTinggi = calculateBBTinggi(tinggi_badan, berat_badan, jenis_kelamin);

            status_gizi_bb_umur.value = statusGiziBBUmur;
            status_gizi_bb_tinggi.value = statusGiziBBTinggi;
        }
    });

    document.getElementById('berat_badan').addEventListener('input', function() {
        var umur = parseInt(document.getElementById('umur').value);
        var berat_badan = parseFloat(this.value);
        var tinggi_badan = parseFloat(document.getElementById('tinggi_badan').value);
        var jenis_kelamin = document.getElementById('jenis_kelamin').value;

        if (!isNaN(umur) && berat_badan > 0 && tinggi_badan > 0 && jenis_kelamin) {
            var status_gizi_bb_umur = document.getElementById('status_gizi_bb_umur');
            var status_gizi_bb_tinggi = document.getElementById('status_gizi_bb_tinggi');

            var statusGiziBBUmur = calculateBBUmur(umur, berat_badan, jenis_kelamin);
            var statusGiziBBTinggi = calculateBBTinggi(tinggi_badan, berat_badan, jenis_kelamin);

            status_gizi_bb_umur.value = statusGiziBBUmur;
            status_gizi_bb_tinggi.value = statusGiziBBTinggi;
        }
    });
</script>